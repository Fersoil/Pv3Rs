<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Computes the likelihood of all relationship graphs — RG_inference • Pv3Rs</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Computes the likelihood of all relationship graphs — RG_inference"><meta name="description" content="The likelihood of a relationship graph (RG) can be decomposed over markers,
as we assume that marker data is conditionally independent across markers
given the RG. The likelihood of a RG for one marker is then found by
integrating over all possible IBD (identity-by-descent) partitions that are
consistent with the RG. The probability distribution of these IBD partitions
are always uniform. Since different RGs may use the same IBD, the likelihood
of IPs for each marker are stored in hash tables for improved computational
efficiency."><meta property="og:description" content="The likelihood of a relationship graph (RG) can be decomposed over markers,
as we assume that marker data is conditionally independent across markers
given the RG. The likelihood of a RG for one marker is then found by
integrating over all possible IBD (identity-by-descent) partitions that are
consistent with the RG. The probability distribution of these IBD partitions
are always uniform. Since different RGs may use the same IBD, the likelihood
of IPs for each marker are stored in hash tables for improved computational
efficiency."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">Pv3Rs</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/demonstrate-usage.html">Demonstrate Pv3Rs usage</a></li>
    <li><a class="dropdown-item" href="../articles/intra-episode-siblings.html">Explore treatment of intra-episode siblings</a></li>
    <li><a class="dropdown-item" href="../articles/understand-posterior.html">Understand posterior estimates</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aimeertaylor/Pv3Rs/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Computes the likelihood of all relationship graphs</h1>
      <small class="dont-index">Source: <a href="https://github.com/aimeertaylor/Pv3Rs/blob/main/R/RG_inference.R" class="external-link"><code>R/RG_inference.R</code></a></small>
      <div class="d-none name"><code>RG_inference.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The likelihood of a relationship graph (RG) can be decomposed over markers,
as we assume that marker data is conditionally independent across markers
given the RG. The likelihood of a RG for one marker is then found by
integrating over all possible IBD (identity-by-descent) partitions that are
consistent with the RG. The probability distribution of these IBD partitions
are always uniform. Since different RGs may use the same IBD, the likelihood
of IPs for each marker are stored in hash tables for improved computational
efficiency.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RG_inference</span><span class="op">(</span><span class="va">MOIs</span>, <span class="va">fs</span>, <span class="va">alleles_per_m</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mois">MOIs<a class="anchor" aria-label="anchor" href="#arg-mois"></a></dt>
<dd><p>A numeric vector specifying, for each infection, the number of
distinct parasite genotypes, a.k.a. the multiplicity of infection (MOI).</p></dd>


<dt id="arg-fs">fs<a class="anchor" aria-label="anchor" href="#arg-fs"></a></dt>
<dd><p>List of allele frequencies as vectors. Names of the list must
match with the marker names in <code>alleles_per_m</code>.</p></dd>


<dt id="arg-alleles-per-m">alleles_per_m<a class="anchor" aria-label="anchor" href="#arg-alleles-per-m"></a></dt>
<dd><p>List of allele assignments as dataframes for each
marker. Each column corresponds to a genotype and each row corresponds to
an allele assignment.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>List of all relationship graph objects, including their
log-likelihoods as a variable under each object.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># 1 marker, 2 infections, MOIs = 2, 1</span></span></span>
<span class="r-in"><span><span class="va">MOIs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  m1 <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  m2 <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">al_df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">al_df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"C"</span>,</span></span>
<span class="r-in"><span>  <span class="st">"D"</span>, <span class="st">"C"</span>, <span class="st">"C"</span></span></span>
<span class="r-in"><span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">al_df1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">al_df2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"g"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alleles_per_m</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>m1 <span class="op">=</span> <span class="va">al_df1</span>, m2 <span class="op">=</span> <span class="va">al_df2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">RGs</span> <span class="op">&lt;-</span> <span class="fu">RG_inference</span><span class="op">(</span><span class="va">MOIs</span>, <span class="va">fs</span>, <span class="va">alleles_per_m</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of valid relationship graphs (RGs) is 9</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> |</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing log p(Y|RG) for 9 RGs</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> =========</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> |</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Aimee Taylor, Yong See Foo, European Union, Project 101110393 — PvRecur.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

